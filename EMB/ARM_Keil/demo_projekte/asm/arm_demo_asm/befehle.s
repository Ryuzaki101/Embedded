 	AREA arm1, CODE
	INCLUDE LPC2368_asm.inc
	;Achtung, Inkludieren nur in einer AREA!

	ENTRY
	EXPORT start
	EXPORT SWI_Handler

SWI_Handler
 	LDR	R0,[LR,#-4]
	LDR	R1,=0xFFFFFF
	AND	R0,R0,R1	 ;SWI-Nummer identifizieren

	MRS	R0,SPSR
	BIC	R0,R0,#2_10000000	 ;IRQ=0
	MSR	SPSR_c,R0
	MOVS	PC,LR

meine_tabelle
	DCD	0x11111111
	DCD	0x22222222
	DCD	0x33333333
	DCD	0x44444444
	DCD	0

start
	LDR	R5,=0xFF00FFFF
	LDR	R6,=0xA300C6B4
	EOR	R7,R6,R5
	MOV	R0,#10
	MOV	R1,#2
	ADD	R0,R0,R0,LSL #2
	ADD	R0,R1,R0,LSL #1
	MOV	R2,#3
	MLA	R3,R0,R1,R2	 ;R3=R0*R1+R2
	BIC	R3,R3,#2_00001000

indirekte_Adressierung
	LDR	R5,=0x12345678
	LDR	R6,=0x40000000
	STR	R5,[R6],#4
	STR	R5,[R6,#4]
	MOV	R7,#4
	LDR	R5,=0xDE
	STRB	R5,[R6,-R7]
	LDR	R0,=meine_tabelle
	MOV	R4,#0

schleife
	LDR	R1,[R0],#4
	ADD	R4,R4,R1
	CMP	R1,#0
	BNE	schleife
	LDR	R0,=0x40000010
;
	MOV	R1,#1
	MOV	R2,#2
	MOV	R3,#3
	MOV	R4,#4
	MOV	R5,#5
	MOV	R6,#6
	MOV	R7,#7
	MOV	R8,#8
	MOV	R9,#9
	MOV	R10,#10
	MOV	R11,#11
	MOV	R12,#12
	MOV	R13,#13
	MOV	R14,#14
	STMIA	R0,{R1-R12}
	LDMIA	R0,{R1-R12}
	STMIA	R0,{R1,R2,R7}
	LDMIA	R0,{R1,R3,R6}
	STMIA	R0!,{R1-R12}
	LDMDB	R0!,{R1-R12}
	LDR		R5,=0x55555555
	LDR		R6,=0x66666666
	LDR		R7,=0x77777777
	LDR		R8,=0x88888888
	LDR		R9,=0x99999999
	LDR		LR,=0xAAAAAAAA
	LDR		SP,=0x40000020
	STMFD	SP!,{R5-R9,LR}
	LDMFD	SP!,{R5-R9,LR}
	LDR		R2,=0x40000000
	MOV		R1,#01
	SWPB	R0,R1,[R2]
	SWI	0x123456

stopp
;	B	stopp

	LDR	R0,=FIO2_DIR   ;FIO2_DIR
	LDR	R1,[R0]
	ORR	R1,R1,#0x000000FF
	STR	R1,[R0]
	LDR	R0,=FIO2_SET
	MOV	R1,#2_10000001
	STR	R1,[R0]
	LDR	R0,=FIO2_CLR
	MOV	R1,#2_10000000
	STR	R1,[R0]

	LDR	R0,=FIO4_DIR2   ;FIO4_DIR
	LDR	R1,[R0]
	ORR	R1,R1,#0x000000FF
	STRB	R1,[R0]	 ;STRB store byte notwendig!Sonst Wortgrenze!
	LDR	R0,=FIO4_SET2
	MOV	R1,#2_10011001
	STRB	R1,[R0]
	LDR	R0,=FIO4_CLR2
	MOV	R1,#2_10000001
	STRB	R1,[R0]

halt
	B	halt
	END